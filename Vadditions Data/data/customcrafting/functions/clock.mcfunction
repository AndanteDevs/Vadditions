#validity check
execute as @e[tag=VADS_CustomCrafter,type=minecraft:armor_stand] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true]{Items:[]} run function customcrafting:recipe_validity_check

#reset stack sizes/slot count on empty crafters
execute as @e[tag=VADS_CustomCrafter,type=minecraft:armor_stand] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[{}]} run scoreboard players set @s[scores={VADS_SlotCount=1..}] VADS_SlotCount 0
execute as @e[tag=VADS_CustomCrafter,type=minecraft:armor_stand] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[{}]} run scoreboard players set @s[scores={VADS_StackSize=1..}] VADS_StackSize 0

#run recipe checks
execute as @e[type=minecraft:armor_stand,tag=VADS_BasicCrafter] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:basic/recipe_check
execute as @e[type=minecraft:armor_stand,tag=VADS_AdvancedCrafter] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:advanced/recipe_check
execute as @e[type=minecraft:armor_stand,tag=VADS_Compressor] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:compressor/recipe_check
execute as @e[type=minecraft:armor_stand,tag=VADS_MachineCrafter] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:machine/recipe_check
execute as @e[type=minecraft:armor_stand,tag=VADS_Smeltry] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:smeltry/recipe_check
execute as @e[type=minecraft:armor_stand,tag=VADS_Uncrafter] at @s unless block ~ ~ ~ #vadditions:holds/customcrafter{Items:[]} unless block ~ ~ ~ #vadditions:holds/customcrafter[triggered=true] run function customcrafting:uncrafting/recipe_check

#brightness
execute unless score Daytime VADS_Overall matches 13000..23400 as @e[type=minecraft:armor_stand,tag=VADS_FireStand,scores={VADS_Fire=..10}] run data merge entity @s {Invulnerable:1,Marker:1,Fire:20s}

#run creation checks
execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:iron_block",Count:8b},OnGround:1b}] at @s if entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:redstone",Count:1b},OnGround:1b},distance=...75] if block ~ ~-1 ~ minecraft:dropper[facing=up]{Items:[]} unless entity @e[type=minecraft:armor_stand,tag=VADS_CustomCrafter,distance=..1] align xz run function customcrafting:machine/create
execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:crafting_table",Count:1b},OnGround:1b}] at @s if block ~ ~-1 ~ minecraft:dropper[facing=up]{Items:[{Slot:0b,id:"minecraft:cobblestone",Count:1b},{Slot:1b,id:"minecraft:iron_ingot",Count:1b},{Slot:2b,id:"minecraft:cobblestone",Count:1b},{Slot:3b,id:"minecraft:iron_ingot",Count:1b},{Slot:5b,id:"minecraft:iron_ingot",Count:1b},{Slot:6b,id:"minecraft:cobblestone",Count:1b},{Slot:7b,id:"minecraft:redstone",Count:1b},{Slot:8b,id:"minecraft:cobblestone",Count:1b}]} unless entity @e[type=minecraft:armor_stand,tag=VADS_CustomCrafter,distance=..1] align xz run function customcrafting:basic/create
execute as @e[type=minecraft:armor_stand,nbt={Tags:["VADS_Entity","VADS_BasicCrafter"]}] at @s run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:obsidian",Count:1b},OnGround:1b},distance=..1] at @s run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:diamond",Count:4b},OnGround:1b},distance=..1] run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:iron_block",Count:1b},OnGround:1b},distance=..1] at @s run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:crafting_table",Count:1b},OnGround:1b},distance=..1] at @s unless entity @e[type=minecraft:armor_stand,tag=VADS_CustomCrafter,tag=!VADS_BasicCrafter,distance=..1] if block ~ ~-1 ~ minecraft:dropper[facing=up]{Items:[]} align xz run function customcrafting:advanced/create
execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:piston",Count:1b},OnGround:1b}] at @s run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:iron_block",Count:1b},OnGround:1b},distance=..1] run execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:redstone",Count:1b},OnGround:1b},distance=..1] at @s unless entity @e[type=minecraft:armor_stand,tag=VADS_Compressor,distance=..1] if block ~ ~-1 ~ minecraft:dropper[facing=up]{Items:[]} align xz run function customcrafting:compressor/create
execute as @e[type=minecraft:item,nbt={Item:{Count:1b,tag:{isMachine:1b,VADS_Machine:"vadditions:smeltry"}}},tag=!VADS_NoSummon] at @s store result score @s VADS_SmltryCnt align xyz if entity @e[type=minecraft:item,nbt={Item:{Count:1b,tag:{isMachine:1b,VADS_Machine:"vadditions:smeltry"}}},dx=1,dy=1,dz=1,tag=!VADS_NoSummon]
execute as @e[type=minecraft:item,nbt={Item:{Count:1b,tag:{isMachine:1b,VADS_Machine:"vadditions:smeltry"}},OnGround:1b},tag=!VADS_NoSummon,scores={VADS_SmltryCnt=1}] at @s if block ~ ~ ~ #minecraft:air align xz run function customcrafting:smeltry/create
execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:crafting_table",Count:1b,tag:{display:{Name:"{\"text\":\"Dinnerbone\"}"}}},OnGround:1b}] at @s if block ~ ~-1 ~ minecraft:dispenser unless entity @e[type=minecraft:armor_stand,tag=VADS_CustomCrafter,distance=..1] align xz run function customcrafting:uncrafting/create
execute as @e[type=minecraft:item,nbt={Item:{id:"minecraft:crafting_table",Count:1b,tag:{display:{Name:"{\"text\":\"Grumm\"}"}}},OnGround:1b}] at @s if block ~ ~-1 ~ minecraft:dispenser unless entity @e[type=minecraft:armor_stand,tag=VADS_CustomCrafter,distance=..1] align xz run function customcrafting:uncrafting/create

#kill basic crafters on top of advanced crafters
execute at @e[type=minecraft:armor_stand,tag=VADS_AdvancedCrafter] run kill @e[tag=VADS_BasicCrafter,distance=..1]